# =============================================================================
# SETTINGS-02: Navigation
# Verifies that each settings row on the Profile screen navigates to its
# respective sub-screen and that the user can return to the Profile screen.
# Tests: Notifications, Privacy & Consent.
# =============================================================================
appId: com.mindlog.app

---

# Launch with a clean slate
- launchApp:
    clearState: true

# Connect to Metro dev server (Expo Dev Client)
- runFlow: ../../subflows/connect_dev_server.yaml

# Sign in as the demo patient
- runFlow: ../../subflows/sign_in.yaml

# Navigate to the Profile tab
- tapOn:
    text: "Profile"

# Wait for Profile screen to load
- extendedWaitUntil:
    visible:
      text: "Profile"
    timeout: 10000

# ── Navigate to Notifications ─────────────────────────────────────────────────

- tapOn:
    text: "Notifications"

# Wait for the Notifications screen to render
- extendedWaitUntil:
    visible:
      text: "Notifications"
    timeout: 3000

# Go back to Profile
- tapOn:
    text: "Back"
    optional: true

# Fallback: press device back button if no Back text is found
- back:
    optional: true

# ── Navigate to Privacy & Consent ─────────────────────────────────────────────

# Wait for Profile to re-render before tapping next row
- extendedWaitUntil:
    visible:
      text: "Privacy & Consent"
    timeout: 3000

- tapOn:
    text: "Privacy & Consent"

# Wait for the Privacy & Consent screen to render
- extendedWaitUntil:
    visible:
      text: "Privacy"
    timeout: 3000

# Go back to Profile
- tapOn:
    text: "Back"
    optional: true

# Fallback: press device back button if no Back text is found
- back:
    optional: true

# Verify we are back on the Profile screen
- extendedWaitUntil:
    visible:
      text: "Profile"
    timeout: 5000

- takeScreenshot: screenshots/settings_navigation
